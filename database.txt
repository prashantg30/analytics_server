SET SQL_SAFE_UPDATES = 0;

#
ALTER TABLE client_twitter_data RENAME COLUMN data_client_name TO data_source_name;
#
ALTER TABLE `client_twitter_data` 
 ADD COLUMN `format_name` varchar(255)
 AFTER `client_id`;
#
ALTER TABLE `analytics_data`.`clients` 
CHANGE COLUMN `client_id` `client_id` VARCHAR(60) NULL ,
ADD UNIQUE INDEX `client_id_UNIQUE` (`client_id` ASC);
#

// let query2 = `SELECT * FROM INFORMATION_SCHEMA.COLUMNS 
// WHERE TABLE_NAME='${tableName}' AND column_name='client_id'`;



create database analytics_data;
use analytics_data;

create table login (
    id int auto_increment primary key,
    username varchar(60),
    password varchar(255), 
    created_at timestamp default current_timestamp, 
    updated_at timestamp default current_timestamp on update current_timestamp
);
insert into login (username,password) values('test1','123456');

create table clients (
    client_id int auto_increment primary key,
    client_name varchar(255), 
    created_at timestamp default current_timestamp, 
    updated_at timestamp default current_timestamp on update current_timestamp
);

create table data_source (
    data_source_id int auto_increment primary key,
    data_source_name varchar(255) unique not null, 
    created_at timestamp default current_timestamp, 
    updated_at timestamp default current_timestamp on update current_timestamp
);

create table formats (
    id int auto_increment primary key,
    format_name varchar(255) not null,
    data_source_id int not null,
    field_names text,
    field_details JSON NOT NULL, 
    created_at timestamp default current_timestamp, 
    updated_at timestamp default current_timestamp on update current_timestamp
);

    //JOIN
    SELECT data_source.data_source_id, data_source.data_source_name, formats.data_source_id, formats.field_details
    FROM data_source
    INNER JOIN formats ON formats.data_source_id = data_source.data_source_id;


{
    formatName : "abc",
    dataSourceId: 1,
    fieldDetails: [
        {
            fieldName:"name",
            displayName:"Name of the Person",
            datatype:"text",
        },
        {
            fieldName:"Age",
            displayName:"Age of the Person",
            datatype:"number",
        }
    ]
}

 --> create table data_source_name+_+format_slug
     field_name double/datatype,
     field_name double/datatype


create table integrations (
    id int auto_increment primary key,
    integration_id varchar(60),
    name varchar(255)
);

create table client_dv360_data(
    id int auto_increment primary key,
    client_id varchar(255) not null,
    data_source_name varchar(255) not null,
    date varchar(255),
    insertion_order varchar(255), 
    city varchar(255), 
    total_media_cost varchar(255),
    impressions varchar(255),
    clicks varchar(255),
    midpoint_views varchar(255),
    viewable_impressions varchar(255),
    created_at timestamp default current_timestamp, 
    updated_at timestamp default current_timestamp on update current_timestamp
);

create table client_facebook_data(
    id int auto_increment primary key,
    client_id varchar(255) not null,
    data_source_name varchar(255) not null,
    reporting_starts varchar(255),
    reporting_ends varchar(255), 
    ad_name varchar(255), 
    age varchar(255),
    gender varchar(255),
    ad_set_name varchar(255),
    campaign_name varchar(255), 
    amount_spent varchar(255),
    impressions varchar(255),
    clicks varchar(255),
    video_plays varchar(255),
    created_at timestamp default current_timestamp, 
    updated_at timestamp default current_timestamp on update current_timestamp
);


create table client_google_data(
    id int auto_increment primary key,
    client_id varchar(255) not null,
    data_source_name varchar(255) not null,
    day datetime not null,
    campaign varchar(255),
    campaign_type varchar(60), 
    ad_group varchar(255),
    placement_group varchar(255), 
    currency_code varchar(255),
    cost varchar(255),
    impr varchar(255),
    clicks varchar(255),
    created_at timestamp default current_timestamp, 
    updated_at timestamp default current_timestamp on update current_timestamp
);


create table client_sizmic_data(
    id int auto_increment primary key,
    client_id varchar(255) not null,
    data_source_name varchar(255) not null,
    day datetime not null,
    campaign varchar(255),
    ad_name varchar(255), 
    site_name varchar(255),
    placement_id varchar(255),
    city_name varchar(255),
    impressions_net varchar(255),
    clicks_net varchar(255),
    created_at timestamp default current_timestamp, 
    updated_at timestamp default current_timestamp on update current_timestamp
);

create table client_twitter_data(
    id int auto_increment primary key,
    client_id varchar(255) not null,
    data_source_name varchar(255) not null,
    time_period datetime,
    placement varchar(255),
    gender varchar(255),
    spend varchar(255), 
    impressions varchar(255),
    clicks varchar(255),
    video_views varchar(255),
    created_at timestamp default current_timestamp, 
    updated_at timestamp default current_timestamp on update current_timestamp
);

